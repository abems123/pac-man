version: 2.1

jobs:
  build:
    docker:
      - image: cimg/base:24.04

    steps:
      - checkout

      - run:
          name: Install build dependencies
          command: |
            sudo apt-get update
            sudo apt-get install -y \
              build-essential \
              cmake \
              g++-13 \
              clang-18 \
              libsfml-dev

      - run:
          name: Verify toolchain versions
          command: |
            cmake --version
            g++ --version
            clang++-18 --version
            dpkg -l | grep libsfml

      - run:
          name: Configure (CMake)
          command: |
            cmake -S . -B build -DCMAKE_BUILD_TYPE=Release

      - run:
          name: Build
          command: |
            cmake --build build --parallel

workflows:
  build_and_test:
    jobs:
      - build